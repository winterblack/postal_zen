!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(n,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(n)),e(t)}:e(window.jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{}),e.FE.URLRegEx="(\\s|^|>)(((http|https|ftp|ftps)\\:\\/\\/)?[a-zA-Z0-9\\-\\.]+(\\.[a-zA-Z]{2,3})(:\\d*)?(\\/[^\\s<]*)?)(\\s|$|<)",e.FE.PLUGINS.url=function(n){function t(e){for(;e.parentNode;)if(e=e.parentNode,["A","BUTTON","TEXTAREA"].indexOf(e.tagName)>=0)return!0;return!1}function o(){for(var o,r=n.doc.createTreeWalker(n.el,NodeFilter.SHOW_TEXT,n.node.filter(function(n){return new RegExp(e.FE.URLRegEx,"gi").test(n.textContent.replace(/&nbsp;/gi," "))&&!t(n)}),!1),a=[];r.nextNode();)o=r.currentNode,a.push(o);for(var i=0;i<a.length;i++){o=a[i];var l=null;n.opts.linkAlwaysNoFollow&&(l="nofollow"),n.opts.linkAlwaysBlank&&(l?l+=" noopener noreferrer":l="noopener noreferrer"),e(o).before(o.textContent.replace(new RegExp(e.FE.URLRegEx,"gi"),"$1<a"+(n.opts.linkAlwaysBlank?' target="_blank"':"")+(l?' rel="'+l+'"':"")+' href="$2">$2</a>$8')),o.parentNode.removeChild(o)}}function r(){n.events.on("paste.afterCleanup",function(t){if(new RegExp(e.FE.URLRegEx,"gi").test(t))return t.replace(new RegExp(e.FE.URLRegEx,"gi"),"$1<a"+(n.opts.linkAlwaysBlank?' target="_blank"':"")+(n.opts.linkAlwaysNoFollow?' rel="nofollow"':"")+' href="$2">$2</a>$8')}),n.events.on("keyup",function(t){var r=t.which;r!=e.FE.KEYCODE.ENTER&&r!=e.FE.KEYCODE.SPACE||o(n.node.contents(n.el))},!0),n.events.on("keydown",function(t){if(t.which==e.FE.KEYCODE.ENTER){var o=n.selection.element();if(("A"==o.tagName||e(o).parents("a").length)&&n.selection.info(o).atEnd)return t.stopImmediatePropagation(),"A"!==o.tagName&&(o=e(o).parents("a")[0]),e(o).after("&nbsp;"+e.FE.MARKERS),n.selection.restore(),!1}})}return{_init:r}}});